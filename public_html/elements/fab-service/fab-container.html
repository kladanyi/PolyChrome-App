<dom-module id="fab-container">
    <style is="custom-style">
        :host {
            display: block;
            position: absolute;
            height: 100%;
            width: 100%;
        }
        paper-fab.fab-left-bottom {
            position: absolute;
            bottom: 32px;
            right: 52px;
            z-index: 9999;
        }
    </style>
    <template>
        <template is="dom-if" if="{{currentFab}}">
            <paper-fab id="def" icon="{{currentFab.icon}}" class="fab-left-bottom" on-click="clickFab"></paper-fab>
        </template>
    </template>
</dom-module>
<script>
    (function () {
        Polymer({
            is: 'fab-container',
            behaviors: [MyUtils, FabBehavior],
            properties: {
                fabs: {
                    type: Object,
                    value: {}
                },
                fabList: {
                    type: Array,
                    value: []
                },
                currentFab: Object
            },
            addFab: function (id, icon, onClick) {
//                console.log('Add fab: ' + id);
                if (this.fabList.indexOf(id) > -1) {
                    this.removeFab(id);
                }
                this.currentFab = {
                    icon: icon,
                    onClick: onClick
                };
                MyUtils.JSON.addElement(this.fabs, id, this.currentFab);
                this.fabList.push(id);
            },
            removeFab: function (id) {
                var index = this.fabList.indexOf(id);
                if (index > -1) {
                    this.fabList.splice(index, 1);
                    MyUtils.JSON.removeElement(this.fabs, id);
                }
                index = this.fabList.length - 1;
                if (index > -1) {
                    this.currentFab = MyUtils.JSON.getElement(this.fabs, this.fabList[index]);
                } else {
                    this.currentFab = null;
                }
            },
            clickFab: function () {
                this.currentFab.onClick();
            },
            register: function () {
                FabBehavior.setFabContainer(this);
            }
        });
    })();
</script>
